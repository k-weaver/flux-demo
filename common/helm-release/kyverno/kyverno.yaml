apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: kyverno
  namespace: kyverno
spec:
  interval: 5m
  chart:
    spec:
      chart: kyverno
      version: 3.3.1
      sourceRef:
        kind: HelmRepository
        name: kyverno
        namespace: flux-system
  values:
    validationFailureActionByPolicy:
      disallow-capabilities: 'Audit'
      disallow-host-namespaces: 'Audit'
      disallow-host-path: 'Audit'
      disallow-host-ports: 'Audit'
      disallow-host-process: 'Audit'
      disallow-privileged-containers: 'Audit'
      disallow-proc-mount: 'Audit'
      disallow-selinux: 'Audit'
      restrict-apparmor-profiles: 'Audit'
      restrict-seccomp: 'Audit'
      restrict-sysctls: 'Audit'
      disallow-capabilities-strict: 'Audit'
      disallow-privilege-escalation: 'Audit'
      require-run-as-non-root-user: 'Audit'
      require-run-as-nonroot: 'Audit'
      restrict-seccomp-strict: 'Audit'
      restrict-volume-types: 'Audit'
  valuesFrom:
    - configMapKeyRef:
        name: kyverno-values
        key: values.yaml
